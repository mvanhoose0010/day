<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Date Auto-Updater With Multiple Rows</title>
<style>
  body {
    font-family: Arial, sans-serif;
    padding: 20px;
    max-width: 1200px;
    margin: auto;
  }

  textarea {
    width: 100%;
    height: 180px;
    font-size: 18px;
    white-space: nowrap;
    overflow-x: auto;
  }

  input {
    font-size: 18px;
    padding: 5px;
    width: 100px;
    margin-left: 10px;
  }

  .result-box {
    background: #f4f4f4;
    padding: 15px;
    margin-top: 20px;
    border-radius: 8px;
  }

  pre {
    white-space: pre-wrap;
    font-size: 18px;
    overflow-x: auto;
  }

  #copyBtn {
    margin-top: 10px;
  }
</style>
</head>
<body>

<h2>Date Auto-Updater (Multiple Sequential Rows)</h2>

<p>Paste your full line below:</p>
<textarea id="inputText"></textarea>
<br><br>

<label>Number of rows:</label>
<input type="number" id="rowCount" value="1" min="1">

<br><br>
<button onclick="processDates()">Generate Rows</button>
<button id="copyBtn" onclick="copyOutput()" style="display:none;">Copy Output</button>

<div id="results" class="result-box" style="display:none;">
  <h3>Output:</h3>
  <pre id="output"></pre>
</div>

<script>
function addOneDay(dateObj, days = 1) {
    const d = new Date(dateObj);
    d.setDate(d.getDate() + days);
    return d;
}

function formatYYYYMMDD(dateObj) {
    return dateObj.toISOString().split("T")[0];
}

function formatMMDDYY(dateObj) {
    const mm = String(dateObj.getMonth() + 1).padStart(2, "0");
    const dd = String(dateObj.getDate()).padStart(2, "0");
    const yy = String(dateObj.getFullYear()).slice(-2);
    return mm + dd + yy;
}

// Extracts and returns: { idDate, full1, full2 }
function extractDates(line) {
    // Embedded MMDDYY (e.g., 111925)
    const embeddedMatch = line.match(/\d{6}/);

    // Two YYYY-MM-DD
    const fullDates = [...line.matchAll(/\b\d{4}-\d{2}-\d{2}\b/g)].map(m => m[0]);

    return {
        embedded: embeddedMatch ? embeddedMatch[0] : null,
        full1: fullDates[0] || null,
        full2: fullDates[1] || null
    };
}

function generateLine(baseLine, dates, offset) {
    let line = baseLine;

    // --- Embedded MMDDYY update ---
    if (dates.embedded) {
        const mm = Number(dates.embedded.slice(0, 2));
        const dd = Number(dates.embedded.slice(2, 4));
        const yy = Number(dates.embedded.slice(4, 6));

        const year = yy < 50 ? 2000 + yy : 1900 + yy;
        const parsed = new Date(year, mm - 1, dd);
        const next = addOneDay(parsed, offset);

        const new6 = formatMMDDYY(next);
        line = line.replace(dates.embedded, new6);
    }

    // --- Full date 1 ---
    if (dates.full1) {
        const next = addOneDay(new Date(dates.full1), offset);
        line = line.replace(dates.full1, formatYYYYMMDD(next));
    }

    // --- Full date 2 ---
    if (dates.full2) {
        const next = addOneDay(new Date(dates.full2), offset);
        line = line.replace(dates.full2, formatYYYYMMDD(next));
    }

    return line;
}

function processDates() {
    const baseLine = document.getElementById("inputText").value;
    const count = Number(document.getElementById("rowCount").value);

    const dates = extractDates(baseLine);

    let output = "";

    for (let i = 0; i < count; i++) {
        output += generateLine(baseLine, dates, i + 1) + "\n";
    }

    document.getElementById("output").textContent = output.trim();
    document.getElementById("results").style.display = "block";
    document.getElementById("copyBtn").style.display = "block";
}

function copyOutput() {
    const text = document.getElementById("output").textContent;
    navigator.clipboard.writeText(text);
}
</script>

</body>
</html>